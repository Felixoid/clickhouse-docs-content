"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[55658],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?i.createElement(h,a(a({ref:t},u),{},{components:n})):i.createElement(h,a({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var c=2;c<o;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},86113:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var i=n(87462),r=n(63366),o=(n(67294),n(3905)),a=["components"],s={sidebar_label:"Limitations",sidebar_position:8,description:"Limitations of the dbt ClickHouse plugin"},l="Limitations",c={unversionedId:"en/integrations/dbt/dbt-limitations",id:"en/integrations/dbt/dbt-limitations",title:"Limitations",description:"Limitations of the dbt ClickHouse plugin",source:"@site/docs/en/integrations/dbt/dbt-limitations.md",sourceDirName:"en/integrations/dbt",slug:"/en/integrations/dbt/dbt-limitations",permalink:"/docs/en/integrations/dbt/dbt-limitations",editUrl:"https://github.com/ClickHouse/clickhouse-docs/blob/main/docs/en/integrations/dbt/dbt-limitations.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_label:"Limitations",sidebar_position:8,description:"Limitations of the dbt ClickHouse plugin"},sidebar:"english",previous:{title:"Seeds",permalink:"/docs/en/integrations/dbt/dbt-seeds"},next:{title:"JDBC",permalink:"/docs/en/integrations/jdbc"}},u={},p=[],d={toc:p};function m(e){var t=e.components,n=(0,r.Z)(e,a);return(0,o.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"limitations"},"Limitations"),(0,o.kt)("p",null,"The current ClickHouse plugin for dbt has several limitations users should be aware of:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"As noted in ",(0,o.kt)("a",{parentName:"p",href:"./dbt-incremental-model#internals"},"Creating an Incremental Materialization"),", incremental changes are currently loaded into an in-memory table. ClickHouse does not provide distribution for this table, so changesets must not be larger than the memory of the orchestrator node receiving the query. Users should either avoid using the plugin on datasets where changes/additions are very high or schedule this operation to run at appropriate intervals to ensure all changes can be captured within memory limits. As noted",(0,o.kt)("a",{parentName:"p",href:"https://clickhouse.com/docs/en/engines/table-engines/special/memory"}," here"),", we recommend that in-memory table engines should not exceed 100 million rows. Use this as an upper bound and schedule dbt run\u2019s accordingly, i.e., ensure that the execution interval is frequent enough to not exceed this limit.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"The plugin currently materializes models as tables using an ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT TO SELECT"),". This effectively means data duplication. Very large datasets (PB) can result in extremely long run times, making some models unviable. Aim to minimize the number of rows returned by any query, utilizing GROUP BY where possible. Prefer models which summarize data over those which simply perform a transform whilst maintaining row counts of the source.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://docs.getdbt.com/docs/building-a-dbt-project/building-models/materializations#ephemeral"},"Ephemeral materializations")," are not supported.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To use Distributed tables to represent a model, users must create the underlying replicated tables on each node manually. The Distributed table can, in turn, be created on top of these. The plugin does not manage cluster creation.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Only the ClickHouse native protocol is supported. There is no support for HTTP.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"When dbt creates a relation (table/view) in a database, it usually creates it as: ",(0,o.kt)("inlineCode",{parentName:"p"},"{{ database }}.{{ schema }}.{{ table/view id }}"),". ClickHouse has no notion of schemas. The plugin therefore uses ",(0,o.kt)("inlineCode",{parentName:"p"},"{{schema}}.{{ table/view id }}"),", where ",(0,o.kt)("inlineCode",{parentName:"p"},"schema")," is the ClickHouse database."))),(0,o.kt)("p",null,"Further Information"),(0,o.kt)("p",null,"The previous guides only touch the surface of dbt functionality. Users are recommended to read the excellent ",(0,o.kt)("a",{parentName:"p",href:"https://docs.getdbt.com/docs/introduction"},"dbt documentation"),"."),(0,o.kt)("p",null,"Additional configuration for the plugin is described ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/silentsokolov/dbt-clickhouse#model-configuration"},"here"),"."))}m.isMDXComponent=!0}}]);