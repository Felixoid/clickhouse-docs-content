"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[45278],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,f=d["".concat(l,".").concat(m)]||d[m]||u[m]||a;return n?o.createElement(f,s(s({ref:t},p),{},{components:n})):o.createElement(f,s({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,s=new Array(a);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},39637:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return u}});var o=n(87462),r=n(63366),a=(n(67294),n(3905)),s=["components"],i={sidebar_position:20,sidebar_label:"PostgreSQL Interface"},l="PostgreSQL Interface",c={unversionedId:"en/interfaces/postgresql",id:"en/interfaces/postgresql",title:"PostgreSQL Interface",description:"ClickHouse supports the PostgreSQL wire protocol, which allows you to use Postgres clients to connect to ClickHouse. In a sense, ClickHouse can pretend to be a PostgreSQL instance - allowing you to connect a PostgreSQL client application to ClickHouse that is not already directy supported by ClickHouse (for example, Amazon Redshift).",source:"@site/docs/en/interfaces/postgresql.md",sourceDirName:"en/interfaces",slug:"/en/interfaces/postgresql",permalink:"/docs/en/interfaces/postgresql",editUrl:"https://github.com/ClickHouse/ClickHouse/tree/master/docs/en/interfaces/postgresql.md",tags:[],version:"current",sidebarPosition:20,frontMatter:{sidebar_position:20,sidebar_label:"PostgreSQL Interface"},sidebar:"english",previous:{title:"MySQL Interface",permalink:"/docs/en/interfaces/mysql"},next:{title:"Input and Output Formats",permalink:"/docs/en/interfaces/formats"}},p={},u=[{value:"Connect psql to ClickHouse",id:"connect-psql-to-clickhouse",level:2},{value:"Using SSL",id:"using-ssl",level:2}],d={toc:u};function m(e){var t=e.components,n=(0,r.Z)(e,s);return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"postgresql-interface"},"PostgreSQL Interface"),(0,a.kt)("p",null,"ClickHouse supports the PostgreSQL wire protocol, which allows you to use Postgres clients to connect to ClickHouse. In a sense, ClickHouse can pretend to be a PostgreSQL instance - allowing you to connect a PostgreSQL client application to ClickHouse that is not already directy supported by ClickHouse (for example, Amazon Redshift)."),(0,a.kt)("p",null,"To enable the PostgreSQL wire protocol, add the ",(0,a.kt)("a",{parentName:"p",href:"../operations/server-configuration-parameters/settings#server_configuration_parameters-postgresql_port"},"postgresql_port")," setting to your server's configuration file. For example, you could define the port in a new XML file in your ",(0,a.kt)("inlineCode",{parentName:"p"},"config.d")," folder:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<clickhouse>\n    <postgresql_port>9005</postgresql_port>\n</clickhouse>\n")),(0,a.kt)("p",null,"Startup your ClickHouse server and look for a log message similar to the following that mentions ",(0,a.kt)("strong",{parentName:"p"},"Listening for PostgreSQL compatibility protocol"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"{} <Information> Application: Listening for PostgreSQL compatibility protocol: 127.0.0.1:9005\n")),(0,a.kt)("h2",{id:"connect-psql-to-clickhouse"},"Connect psql to ClickHouse"),(0,a.kt)("p",null,"The following command demonstrates how to connect the PostgreSQL client ",(0,a.kt)("inlineCode",{parentName:"p"},"psql")," to ClickHouse:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"psql -p [port] -h [hostname] -U [username] [database_name]\n")),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"psql -p 9005 -h 127.0.0.1 -U alice default\n")),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"psql")," client requires a login with a password, so you will not be able connect using the ",(0,a.kt)("inlineCode",{parentName:"p"},"default")," user with no password. Either assign a password to the ",(0,a.kt)("inlineCode",{parentName:"p"},"default")," user, or login as a different user."))),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"psql")," client prompts for the password:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},'Password for user alice:\npsql (14.2, server 22.3.1.1)\nWARNING: psql major version 14, server major version 22.\n         Some psql features might not work.\nType "help" for help.\n\ndefault=>\n')),(0,a.kt)("p",null,"And that's it! You now have a PostgreSQL client connected to ClickHouse, and all commands and queries are executed on ClickHouse."),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The PostgreSQL protocol currently only supports plain-text passwords."))),(0,a.kt)("h2",{id:"using-ssl"},"Using SSL"),(0,a.kt)("p",null,"If you have SSL/TLS configured on your ClickHouse instance, then ",(0,a.kt)("inlineCode",{parentName:"p"},"postgresql_port")," will use the same settings (the port is shared for both secure and unsecure clients)."),(0,a.kt)("p",null,"Each client has their own method of how to connect using SSL. The following command demonstrates how to pass in the certificates and key to securely connect ",(0,a.kt)("inlineCode",{parentName:"p"},"psql")," to ClickHouse:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'psql "port=9005 host=127.0.0.1 user=alice dbname=default sslcert=/path/to/certificate.pem sslkey=/path/to/key.pem sslrootcert=/path/to/rootcert.pem sslmode=verify-ca"\n')),(0,a.kt)("p",null,"View the ",(0,a.kt)("a",{parentName:"p",href:"https://jdbc.postgresql.org/documentation/head/ssl-client.html"},"PostgreSQL docs")," for more details on their SSL settings."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://clickhouse.com/docs/en/interfaces/postgresql"},"Original article")))}m.isMDXComponent=!0}}]);